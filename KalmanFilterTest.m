wo=[0;0];
K=c*eye(2);
A(1)=wo'*K*[0,0]'+Jmin;
G=K*[0,0]'*inv(A(1));
a=conj(u(1))-[0;0]'*wo;
wo=wo+G*a;
K=K-G*[0;0]'*K;
e(1)=u(1)-[0,0]*conj(wo);
ei(1,q)=abs(e(1))^2;
%%当n=2时
A(2)=[u(1);0]'*K*[u(1),0]'+Jmin;
G=K*[u(1),0]'*inv(A(2));
a=conj(u(2))-[u(1);0]'*wo;
wo=wo+G*a;
K=K-G*[u(1);0]'*K;
e(2)=u(2)-[u(1),0]*conj(wo);
ei(2,q)=abs(e(2))^2;
%当n>=3时,用kalman滤波迭代
for n=3:N2
A(n)=[u(n-1);u(n-2)]'*K*[u(n-1),u(n-2)]'+Jmin;
G=K*[u(n-1),u(n-2)]'*inv(A(n));
a=conj(u(n))-[u(n-1);u(n-2)]'*wo;
wo=wo+G*a;
K=K-G*[u(n-1);u(n-2)]'*K;
e(n)=u(n)-[u(n-1),u(n-2)]*conj(wo);
ei(n,q)=abs(e(n))^2;
end